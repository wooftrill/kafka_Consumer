import os
import logging

logging.getLogger().setLevel(logging.INFO)

class SQLUtils:

    @staticmethod
    def update_order_table(table_name,payment_status,order_id,session_id,uid):
        return f"Update external.{table_name} SET payment_status={payment_status} where order_id='{order_id}' and session_id='{session_id}' and uid='{uid}';"

    @staticmethod
    def update_checkout_table(table_name,status,session_id,uid):
        return f"Update external.{table_name} SET status={status} where session_id='{session_id}' and uid='{uid}';"

    @staticmethod
    def update_cart_mapper(table_name,status,session_id,uid):
        return f"Update external.{table_name} SET is_sold={status} where curr_session='{session_id}' and uid='{uid}';"

    @staticmethod
    def find_item_count(table_name, items_id):
        return f"select count from external.{table_name} where items_id ='{items_id}' and is_active= 1;"

    @staticmethod
    def update_inventory(table_name,ldts,count,items_id):
        return f"Update external.{table_name} SET ldts={ldts},count={count} where items_id ='{items_id}'and is_active= 1;"

    @staticmethod
    def check_if_order_id_exist(table_name,order_id):
        return f"select * from {table_name} where order_id='{order_id}';"

    @staticmethod
    def insert_metadata(table_name, args):
        return f"INSERT INTO external.{table_name} VALUES {args};"

    @staticmethod
    def update_cart(table_name,cart_id,ldts):
        return f"update external.{table_name} set is_active=0,ldts={ldts} where cart_id='{cart_id}' and is_active=1"




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































